<aura:component controller="transferLeadController" 
                implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction,lightning:actionOverride" access="global" >
    <!-- <aura:attribute name="recordTypeId" type="string"/>  -->
    <aura:attribute name="sectionLabels" type="Map" default=""/>
    <aura:attribute name="selectedCountry" type="string" />
    <aura:attribute name="selectedCountryCode" type="string" />
    <aura:attribute name="recordId" type="string"/>
    <aura:attribute name="projectName" type="string"/>
    <aura:attribute name="isModalOpen" type="boolean" default="true"/>
    <aura:attribute name="spinner" type="boolean" default="false"/>
    <aura:attribute name="hideProjectName" type="boolean" default="true "/>
    <aura:attribute name="accounts" type="String[]" default="[]"/>
    <aura:attribute name="searchText" type="string" default=""/>
    <aura:attribute name="matchaccounts" type="String[]" default="[]"/>
    <aura:attribute name="allocatedProject" type="String"/>
    <aura:attribute name="ratePerSqFeet" type="Decimal"/>
    <aura:attribute name="plotSize" type="Decimal"/>
    <aura:attribute name="leadSource" type="String"/>
    <aura:attribute name="isChannelPartner" type="boolean"/>
    <aura:attribute name="basicprice" type="Decimal"/>
    <aura:attribute name="userId" type="String"/>
    <aura:attribute name="isSubmitting" type="boolean" default="false"/>
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"></aura:handler>
    <aura:handler name="change" value="{!v.searchText}" action="{!c.searchText}"></aura:handler>
    <aura:attribute name="mainLeadSource" type="String"/>
    <aura:attribute name="isSourceDisabled" type="boolean" default="false"/>
    <aura:attribute name="showSourcingMember" type="boolean" default="true"/>
    
    <div > 
        <aura:if isTrue="{!v.isModalOpen}">
            <lightning:recordEditForm recordTypeId="" objectApiName="Lead" aura:id="myform" onsubmit="{!c.handleSubmit}" onsuccess="{!c.handleSuccess}" onerror="{!c.handleError}"> 
                <!-- Modal/Popup Box starts here-->
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <!-- Modal/Popup Box Header Starts here-->
                        <header class="slds-modal__header">
                            <lightning:buttonIcon iconName="utility:close"
                                                  onclick="{! c.closeModel }"
                                                  alternativeText="close"
                                                  variant="bare-inverse"
                                                  class="slds-modal__close"/>
                            <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">New Lead</h2>
                            
                        </header>
                        <!--Modal/Popup Box Body Starts here-->
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <p>
                                <div class="slds-form">
                                    
                                    <lightning:messages />
                                    
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-1 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <label><b></b></label><br/>
                                                    <lightning:select aura:id="salutation" variant="label-stacked"
                                                                      name="salutation" label="Salutation" required="true">
                                                        <option value="">--None--</option>
                                                        <option value="Mr.">Mr.</option>
                                                        <option value="Mrs.">Mrs.</option>
                                                        <option value="Ms.">Ms.</option>
                                                        <option value="Dr.">Dr.</option>
                                                    </lightning:select>
                                                </div>
                                            </div>
                                            
                                            <div class="slds-size_1-of-1 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <lightning:input aura:id="leadFirstName" variant="label-stacked"
                                                                     name="leadFirstName"
                                                                     label="First Name"
                                                                     required="true"
                                                                     pattern="[A-Za-z ]+"
                                                                     messageWhenPatternMismatch="Please enter alphabets only."
                                                                     />
                                                </div>
                                            </div>
                                            <div class="slds-size_1-of-1 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <lightning:input aura:id="leadName" variant="label-stacked"
                                                                     name="leadName"
                                                                     label="Last Name"
                                                                     required="true"
                                                                     pattern="[A-Za-z ]+"
                                                                     messageWhenPatternMismatch="Please enter alphabets only."
                                                                     />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br/> <br/>
                                    
                                    
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-1 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked"
                                                                      fieldName="Allocated_Project__c"  required='true'/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                
                                                <div class="slds-form-element__control">
                                                    <lightning:inputField variant="label-stacked" fieldName="Country__c" aura:id="CountryLookupField" onchange="{!c.handleCountryChange}" />
                                                </div>
                                                
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                
                                                <div class="slds-form-element__control">
                                                    <lightning:inputField variant="label-stacked" fieldName="Country_Code__c" value="{!v.selectedCountryCode}" disabled="true"/>
                                                </div>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1 ">
                                                <lightning:inputField  variant="label-stacked" fieldName="Phone__c" aura:id="PhoneNumber" required="true" />
                                            </div>
                       
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Secondary_Phone__c" aura:id="secondPhoneNumber" />
                                            </div>
                                            
                                        </div>
                                    </div>
                                    
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <lightning:inputField variant="label-stacked" fieldName="Email" aura:id="email" required="true"/>
                                                </div>
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Secondary_Email__c" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-scope">
                                        
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Source_Type__c" required='true' value="{!v.mainLeadSource}" disabled="{!v.isSourceDisabled}"/>
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Lead_source__c"  required='true' value="{!v.leadSource}" onchange="{!c.isChannelPartner}" disabled="{!v.isSourceDisabled}"/>
                                            </div>
                                        </div>
                                    </div>
                                    <aura:if isTrue="{!v.leadSource == 'Channel Partner'}">
                                        <div class="slds-scope">
                                            <div class="slds-grid slds-wrap slds-text-align_left">
                                                <aura:if isTrue="{!v.showSourcingMember}">
                                                    <!-- When showSourcingMember = true -->
                                                    <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                        <lightning:inputField
                                                                              variant="label-stacked"
                                                                              aura:id="channelPartnerid"
                                                                              fieldName="Channel_Partner__c"
                                                                              required="true"/>
                                                    </div>
                                                    
                                                    <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                        <lightning:inputField
                                                                              variant="label-stacked"
                                                                              fieldName="Sourcing_Member__c"  aura:id="sourcingMember" required="true"/>
                                                    </div>
                                                    
                                                    <!-- ELSE BLOCK -->
                                                    <aura:set attribute="else">
                                                        <div class="slds-size_1-of-1 slds-max-small-size_1-of-1">
                                                            <lightning:inputField
                                                                                  variant="label-stacked"
                                                                                  fieldName="Channel_Partner__c"
                                                                                  required="true"/>
                                                        </div>
                                                    </aura:set>
                                                </aura:if>
                                            </div>
                                            
                                        </div>
                                    </aura:if>
                                    <aura:if isTrue="{!v.leadSource == 'Employee Referral'}">
                                        <div class="slds-scope">
                                            <div class="slds-grid slds-wrap slds-text-align_left">
                                                <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                    <lightning:inputField variant="label-stacked" fieldName="Company_Name__c" />
                                                </div>
                                                <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                    <lightning:inputField variant="label-stacked" fieldName="Designation__c" />
                                                </div>
                                            </div>
                                        </div>
                                    </aura:if>
                                    <aura:if isTrue="{!v.leadSource == 'Customer Referral'}">
                                        <div class="slds-scope">
                                            <div class="slds-grid slds-wrap slds-text-align_left">
                                                <div class="slds-size_1-of-3 slds-max-small-size_1-of-1">
                                                    <lightning:inputField variant="label-stacked" fieldName="Customer_Name__c" />
                                                </div>
                                                <div class="slds-size_1-of-3 slds-max-small-size_1-of-1">
                                                    <lightning:inputField variant="label-stacked" fieldName="Customer_Project_Name__c" />
                                                </div>
                                                
                                                <div class="slds-size_1-of-3 slds-max-small-size_1-of-1">
                                                    <lightning:inputField variant="label-stacked" fieldName="Customer_s_Unit_No__c" />
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </aura:if>
                                    
                            
                                    
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <lightning:inputField variant="label-stacked" fieldName="Unit_Preference__c" />
                                                </div>
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Budget__c" />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <lightning:inputField variant="label-stacked" fieldName="Age__c" />
                                                </div>
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="GenderIdentity" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <div class="slds-form-element__control">
                                                    <lightning:inputField variant="label-stacked" fieldName="Locality_of_Customer__c" />
                                                </div>
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Company_Name_of_Customer__c" />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="slds-scope">
                                        <div class="slds-grid slds-wrap slds-text-align_left">
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Designation_of_Customer__c" />
                                            </div>
                                            <div class="slds-size_1-of-2 slds-max-small-size_1-of-1">
                                                <lightning:inputField variant="label-stacked" fieldName="Company" value="abc" style="display:none" />
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                            </p>
                        </div>
                        <!--Modal/Popup Box Footer Starts here-->
                        <footer class="slds-modal__footer">
                            <!-- <aura:if isTrue="{!!v.spinner}"> -->
                            <lightning:button variant="neutral"
                                              label="Cancel"
                                              title="Cancel"
                                              onclick="{! c.closeModel }"/>
                            <lightning:button variant="brand" type="submit" label="Save" disabled="{!v.isSubmitting}"/>
                            
                            <!--</aura:if> -->
                        </footer>
                    </div>
                    
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
                
            </lightning:recordEditForm> 
        </aura:if>
        <aura:if isTrue="{!v.isSubmitting}">
            <lightning:spinner variant="brand" size="small" class="slds-m-left_x-small"/>
        </aura:if>
    </div>
    
    
    
</aura:component>